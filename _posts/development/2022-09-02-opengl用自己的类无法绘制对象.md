---
title: OpenGL 用自己构造的渲染类无法绘制图像
Author: Yanxi Liu
category: Development
---

这两天学习OpenGL的时候遇到了一个很大的坑，而且似乎网上没有很好的答案，最后在一个大佬的帮助下（甚至看了部分OpenGL的源代码）知道了原因并且解决了。

先来看看这个坑：很多人可能都想过，不把所有的渲染代码都放到main函数中或者是作为单独的全局函数，而是用诸如”TriangleRenderer“之类的对象去渲染对应的图元。我们像平时一样在main函数中创建窗口，然后调用构造函数构造对象，在构造函数中绑定对应的顶点缓冲等等，之后在main函数中调用这个对象的Render方法绘制图案，但是发现画不出任何图案。

这个问题的解法其实很简单：OpenGL的BufferData函数其实并不会拷贝一份传入的内容，而只是获取一个指针，所以缓冲的内容必须是是存在堆上的，比如作为一个类的成员，而不能是函数中存在栈上的临时变量。

综上，我们依旧可以在自己的类中去渲染所需要的图像，但是必须将所需要的变量存在堆上。